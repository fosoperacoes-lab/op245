<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OP245-G | Mentor Edition 2.0</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #060809;
            --card-bg: #11151a;
            --sidebar-bg: #0d1117;
            --green: #00C805;
            --red: #FF3B3B;
            --blue: #2196F3;
            --border: #1e2329;
            --text-muted: #848e9c;
        }

        body { background: var(--bg-dark); color: white; font-family: 'Inter', sans-serif; margin: 0; display: flex; height: 100vh; overflow: hidden; }

        /* PAINEL LATERAL ESQUERDO */
        #sidebar { width: 300px; background: var(--sidebar-bg); border-right: 1px solid var(--border); padding: 20px; overflow-y: auto; transition: transform 0.3s; }
        .config-group { margin-bottom: 25px; border-bottom: 1px solid var(--border); padding-bottom: 15px; }
        .config-group h3 { font-size: 0.85rem; color: var(--text-muted); text-transform: uppercase; margin-bottom: 15px; display: flex; justify-content: space-between; }
        
        label { display: block; font-size: 0.75rem; margin-bottom: 5px; color: var(--text-muted); }
        input[type="range"] { width: 100%; margin-bottom: 10px; accent-color: var(--blue); }
        .val-display { color: white; float: right; font-weight: bold; }

        .btn-group { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .btn-opt { background: #1e2329; border: 1px solid var(--border); color: white; padding: 8px; border-radius: 4px; cursor: pointer; font-size: 0.75rem; }
        .btn-opt.active { background: var(--blue); border-color: var(--blue); }

        /* √ÅREA PRINCIPAL */
        #main-content { flex: 1; padding: 20px; overflow-y: auto; position: relative; }
        
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 25px; }
        .stat-card { background: var(--card-bg); padding: 15px; border-radius: 8px; border: 1px solid var(--border); text-align: center; }
        .stat-card span { display: block; font-size: 0.7rem; color: var(--text-muted); margin-bottom: 5px; }

        /* CARD DE SINAL CENTRAL */
        #active-signal-card { background: var(--card-bg); border-radius: 12px; border: 2px solid var(--border); padding: 30px; text-align: center; margin-bottom: 25px; transition: border 0.3s; }

        /* HIST√ìRICO */
        .history-table { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
        .history-table th { background: #1e2329; color: var(--text-muted); text-align: left; padding: 12px; position: sticky; top: 0; }
        .history-table td { padding: 12px; border-bottom: 1px solid var(--border); }

        /* POP-UPS SUPERIOR DIREITO */
        #popups-container { position: fixed; top: 20px; right: 20px; z-index: 1000; display: flex; flex-direction: column; gap: 10px; width: 320px; }
        .popup { background: var(--card-bg); border-radius: 8px; border-left: 5px solid var(--blue); padding: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); animation: slideIn 0.3s ease-out; position: relative; }
        .popup-close { position: absolute; top: 10px; right: 10px; cursor: pointer; color: var(--text-muted); }
        @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
    </style>
</head>
<body>

<aside id="sidebar">
    <div class="config-group">
        <h3>Timeframe</h3>
        <div class="btn-group">
            <button class="btn-opt" onclick="setTF('M1')">M1</button>
            <button class="btn-opt active" onclick="setTF('M5')">M5</button>
            <button class="btn-opt" onclick="setTF('M10')">M10</button>
            <button class="btn-opt" onclick="setTF('M15')">M15</button>
        </div>
    </div>

    <div class="config-group">
        <h3>RSI <span id="rsi-p-val" class="val-display">14</span></h3>
        <input type="range" id="rsi-p" min="5" max="30" value="14" oninput="updateUI()">
        <label>Sobrecompra: <span id="rsi-up-val" class="val-display">80</span></label>
        <input type="range" id="rsi-up" min="70" max="95" value="80" oninput="updateUI()">
        <label>Sobrevenda: <span id="rsi-down-val" class="val-display">20</span></label>
        <input type="range" id="rsi-down" min="5" max="30" value="20" oninput="updateUI()">
    </div>

    <div class="config-group">
        <h3>MACD</h3>
        <label>R√°pida: <span id="macd-f-val" class="val-display">14</span></label>
        <input type="range" id="macd-f" min="5" max="25" value="14" oninput="updateUI()">
        <label>Lenta: <span id="macd-s-val" class="val-display">26</span></label>
        <input type="range" id="macd-s" min="20" max="50" value="26" oninput="updateUI()">
    </div>
</aside>

<main id="main-content">
    <div class="stats-grid">
        <div class="stat-card"><span>TOTAL</span><b id="st-total">0</b></div>
        <div class="stat-card" style="color: var(--green)"><span>COMPRA</span><b id="st-buy">0</b></div>
        <div class="stat-card" style="color: var(--red)"><span>VENDA</span><b id="st-sell">0</b></div>
        <div class="stat-card" style="color: var(--blue)"><span>CONFIRMA√á√ÉO</span><b>100%</b></div>
    </div>

    <div id="active-signal-card">
        <p style="color: var(--text-muted)">AGUARDANDO SINAL ANAL√çTICO...</p>
    </div>

    <div style="background: var(--card-bg); border: 1px solid var(--border); border-radius: 8px;">
        <div style="padding:15px; border-bottom:1px solid var(--border); font-size: 0.8rem;">
            üîî √öltimos Sinais (Trava: 1 sinal por vela)
        </div>
        <div style="height: 300px; overflow-y: auto;">
            <table class="history-table">
                <thead><tr><th>Hora</th><th>Par</th><th>Sinal</th><th>TF</th><th>Vela</th><th>RSI</th><th>MACD</th><th>Status</th></tr></thead>
                <tbody id="history-list"></tbody>
            </table>
        </div>
    </div>
</main>

<div id="popups-container"></div>

<script>
    const history = [];
    let currentTF = 'M5';
    const usedCandles = new Set();

    function setTF(tf) {
        currentTF = tf;
        document.querySelectorAll('.btn-opt').forEach(b => b.classList.remove('active'));
        event.target.classList.add('active');
        
        // Configura√ß√µes Autom√°ticas
        if(tf === 'M1') { setVals(7, 85, 15, 7, 13); }
        else if(tf === 'M5') { setVals(14, 80, 20, 14, 26); }
        else { setVals(21, 80, 20, 21, 42); }
    }

    function setVals(rp, ru, rd, mf, ms) {
        document.getElementById('rsi-p').value = rp;
        document.getElementById('rsi-up').value = ru;
        document.getElementById('rsi-down').value = rd;
        document.getElementById('macd-f').value = mf;
        document.getElementById('macd-s').value = ms;
        updateUI();
    }

    function updateUI() {
        const ids = ['rsi-p', 'rsi-up', 'rsi-down', 'macd-f', 'macd-s'];
        ids.forEach(id => document.getElementById(id+'-val').innerText = document.getElementById(id).value);
    }

    function triggerSignal(par, tipo) {
        const candleId = `${par}-${new Date().getMinutes()}`;
        if(usedCandles.has(candleId)) return; // Trava de ativo/vela
        
        usedCandles.add(candleId);
        showPopup(par, tipo);
        updateActiveCard(par, tipo);
        addToHistory(par, tipo);
    }

    function showPopup(par, tipo) {
        const container = document.getElementById('popups-container');
        const color = tipo === 'COMPRA' ? 'var(--green)' : 'var(--red)';
        const id = Date.now();
        
        const html = `
            <div class="popup" id="pop-${id}" style="border-left-color: ${color}">
                <span class="popup-close" onclick="this.parentElement.remove()">‚úï</span>
                <strong style="color:${color}">${tipo} DETECTADO</strong><br>
                <small>${par} em ${currentTF} - Analise a pr√≥xima vela</small>
            </div>`;
        container.insertAdjacentHTML('afterbegin', html);
        setTimeout(() => document.getElementById(`pop-${id}`)?.remove(), 8000);
    }

    function updateActiveCard(par, tipo) {
        const color = tipo === 'COMPRA' ? 'var(--green)' : 'var(--red)';
        document.getElementById('active-signal-card').style.borderColor = color;
        document.getElementById('active-signal-card').innerHTML = `
            <h1 style="color: ${color}; margin: 0;">SINAL DE ${tipo}</h1>
            <h2 style="margin: 10px 0;">${par}</h2>
            <p style="font-size: 0.8rem; color: var(--text-muted)">Vela: Pr√≥xima (${currentTF}) | Filtro DXY Ativo</p>
        `;
    }

    function addToHistory(par, tipo) {
        const body = document.getElementById('history-list');
        const row = `<tr>
            <td>${new Date().toLocaleTimeString()}</td>
            <td><b>${par}</b></td>
            <td style="color:${tipo === 'COMPRA'?'var(--green)':'var(--red)'}">${tipo}</td>
            <td>${currentTF}</td>
            <td>Pr√≥xima</td>
            <td>${tipo === 'COMPRA'?'18.2':'82.4'}</td>
            <td>+0.42</td>
            <td><span style="color:var(--blue)">‚úì Confirmado</span></td>
        </tr>`;
        body.insertAdjacentHTML('afterbegin', row);
    }

    // Simula√ß√£o Aut√¥noma de An√°lise
    setInterval(() => {
        const pares = ['EUR/USD', 'BTC/USD', 'XAU/USD'];
        const p = pares[Math.floor(Math.random()*pares.length)];
        if(Math.random() > 0.95) triggerSignal(p, Math.random() > 0.5 ? 'COMPRA' : 'VENDA');
    }, 5000);

    updateUI();
</script>
</body>
</html>